# 常用git组合操作

## fork冲突解决

在 Git 中同步 fork 仓库时，如果出现冲突或提示需要解决冲突的情况，通常是因为你的 fork 仓库与上游（upstream）仓库的代码存在差异。

- 如果需要保留本地提交历史，建议通过 `git merge` 解决冲突。
- 如果不需要保留本地提交历史，可以直接使用 `git reset --hard` 和 `git push --force` 强制同步。

以下是解决此问题的详细步骤：

1. 确认当前状态

   首先，确保你已经克隆了你的 fork 仓库，并且已经添加了上游仓库的远程地址。

   运行以下命令查看当前的远程仓库配置：

   ```bash
   git remote -v
   ```

   如果你没有添加上游仓库，可以使用以下命令添加：

   ```bash
   git remote add upstream <上游仓库的URL>
   ```

2. 获取上游仓库的最新代码

   从上游仓库拉取最新的代码到本地：

   ```bash
   git fetch upstream
   ```

3. 切换到主分支（或其他目标分支）

   确保你在本地的目标分支上操作。例如，如果你要同步的是 `main` 分支：

   ```bash
   git checkout main
   ```

4. 合并上游代码

   将上游仓库的代码合并到你的本地分支：

   ```bash
   git merge upstream/main
   ```

5. 如果出现冲突
   如果合并过程中出现冲突，Git 会提示哪些文件存在冲突。你需要手动解决这些冲突：

   使用以下命令查看冲突的文件：

   ```bash
   git status
   ```

6. 编辑冲突文件

   打开冲突文件，你会看到类似以下的标记：

   ```plaintext
   <<<<<<< HEAD
   你的代码
   =======
   上游仓库的代码
   >>>>>>>
   ```

   根据需求选择保留哪一部分代码，或者手动合并两部分代码。

7. 标记冲突已解决
   编辑完成后，使用以下命令标记冲突已解决：

   ```bash
   git add <冲突文件>
   ```

8. 完成合并
   所有冲突解决后，完成合并：

   ```bash
   git commit
   git push
   ```

9. 强制同步（可选）
   如果你不需要保留本地的提交历史，而是希望直接与上游仓库保持一致，可以通过以下方式强制同步：

   重置分支

   ```bash
   git reset --hard upstream/main
   ```

   这将丢弃本地的所有更改，并使分支与上游仓库完全一致。

   > **注意**：此操作会丢失本地未提交的更改和提交记录，请谨慎操作。

   完成合并或重置后，将更新推送到你的 fork 仓库：

   ```bash
   git push origin main
   ```

   如果之前进行了重置操作，可能需要强制推送：

   ```bash
   git push origin main --force
   ```
